---
title: "CoronaScandinavia"
author: "Stanley"
date: "15/3/2020"
output: pdf_document
---

# Loading libraries
```{r setup, message=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(tensorflow)
library(keras)
library(modelr)
library(lubridate)
library(dlm)
library(forecast)
library(dplyr)
```


## Loading data
```{r message=FALSE}
my_files<- list.files(path = "csse_covid_19_data/csse_covid_19_time_series", full.names = TRUE)

# Storing to a list
X<- my_files %>%
  setNames(nm = .) %>%
  map(read_csv)

# Renaming for each data set
Confirmed<- X[[2]]
Death<- X[[3]]
Recovered<- X[[4]]

```

## Extracting for the confirmed 
```{r}

# Define which data; Confirmed, Death or Recovered
df<- Confirmed


# Setting the date
df<- df %>%
  select('Country/Region','2/25/20':'3/14/20') %>%
  gather(day,incidents,'2/25/20':'3/14/20')

# Preparing
df$day<- as.Date(df$day,"%m/%d/%Y")

df<- df %>%
  group_by(`Country/Region`,day) %>%
  summarise(incidents = sum(incidents))

```


# Extracting the scandinavian countries
```{r}
# Scandinavian
sc<- df %>%
  filter(`Country/Region` %in% c("Denmark","Norway","Sweden"))
```


# Plotting for the scandinavian countries
```{r}
ggplot(sc, aes(day, incidents, color = `Country/Region`)) +
  geom_line() +
  labs(title="Confirmed cases",
        x ="", y = "Incidents")
```

# Creating predictions with arima
```{r}

# Defining Countries
Dk<- filter(df, `Country/Region` == "Denmark")
No<- filter(df, `Country/Region` == "Norway")
Se<- filter(df, `Country/Region` == "Sweden")

# Extracting the the values
yDk<- Dk$incidents
yNo<- No$incidents
ySe<- Se$incidents

# Using auto arima
fitDk <- auto.arima(yDk)
fitNo <- auto.arima(yNo)
fitSe <- auto.arima(ySe)

par(mfrow=c(1,3))
plot(forecast(fitDk, 7), main="DK")
plot(forecast(fitNo, 7), main="NO")
plot(forecast(fitSe, 7), main="Se")
```

